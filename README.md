# 视频自动画中画 (Auto Picture-in-Picture)

利用浏览器原生属性与脚本逻辑相结合，实现的极致稳定、简洁的视频自动画中画工具。

## ✨ 核心功能

*   **🚀 自动开启**：切换浏览器标签页（Tab）或切换桌面应用窗口（Blur）时，自动将正在播放的视频转入画中画。
*   **↩️ 自动恢复**：重新回到视频所在页面时，自动退出画中画并恢复原位播放。
*   **⌨️ 快捷键支持**：随时按 `P` 键手动开启或关闭画中画（支持正在播放或已暂停的视频）。
*   **🛡️ 运行稳定**：基于 `autoPictureInPicture` 原生属性，解决了传统脚本常见的“手势限制”导致无法触发的问题。

## 💡 使用技巧（必读）

由于浏览器的安全限制，**页面加载后请在页面任意位置点击一次**（授权手势）。
*   只要点过一次，后续的“窗口失焦自动进入”和“P键操作”就会 100% 生效。
*   切换标签页触发受原生支持，不受此限制。

## 🛠 配置说明

脚本内置了简单的配置项（在代码顶部）：
```javascript
const CONFIG = {
    enabled: true,  // 是否启用
    debug: true     // 是否在控制台输出运行日志
};
```

## 🔄 逻辑说明

| 动作 | 自动入 PiP | 自动出 PiP | 说明 |
| :--- | :--- | :--- | :--- |
| **切换标签页** | ✅ 是 | ✅ 是 | 极速响应，由浏览器原生处理 |
| **离开浏览器窗口** | ✅ 是 | ✅ 是 | 需执行过一次页面点击激活 |
| **按 P 键** | ✅ 受控 | ✅ 受控 | 手动模式，支持所有视频状态 |

## 📦 安装方式

在使用本脚本前，请先安装浏览器扩展 [Tampermonkey](https://www.tampermonkey.net/)。

### 方法 A：通过 GreasyFork 安装 (推荐)
1. [点击此处访问 GreasyFork 页面](https://greasyfork.org/zh-CN/scripts/562978-%E8%A7%86%E9%A2%91%E8%87%AA%E5%8A%A8%E7%94%BB%E4%B8%AD%E7%94%BB)。
2. 点击“安装此脚本”按钮即可。

### 方法 B：手动复制安装
1. 点击 Tampermonkey 图标，选择“添加新脚本”。
2. 将本代码仓库中的 `auto-pip.user.js` 内容完全覆盖粘贴。
3. 按 `Ctrl+S` (或 `Cmd+S`) 保存即可。

## 📜 版本记录
*   **v4.5**: 支持暂停视频的 P 键开启。
*   **v4.2 - v4.4**: 引入原生属性支持并解决手势限制。
*   **v1.0 - v3.x**: 基础功能迭代及逻辑实验。

---
**Enjoy watching!** 🍿
